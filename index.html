<!DOCTYPE html>
<html lang="pt-br">

<head>
  <meta charset="UTF-8">
  <title>Emily - Gerenciador de Tarefas</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <!-- Bootstrap 5 CDN -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="css/style.css">
</head>

<body>
  <nav id="main-navbar" class="navbar navbar-expand-lg shadow-sm navbar-theme bg-primary">
    <div class="container">
      <a class="navbar-brand fw-bold d-flex align-items-center gap-2 text-white" href="#">
        <span style="font-size:2rem;">üóÇÔ∏è</span>
        <span class="fs-3" style="letter-spacing:1px;">Emily - Tarefas</span>
      </a>
      <button class="navbar-toggler border-0" type="button" data-bs-toggle="collapse"
        data-bs-target="#navbarNavDropdown" aria-controls="navbarNavDropdown" aria-expanded="false"
        aria-label="Alternar navega√ß√£o">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse justify-content-center" id="navbarNavDropdown">
        <ul class="navbar-nav mb-2 mb-lg-0 gap-lg-2">
          <li class="nav-item">
            <a class="nav-link px-3 rounded-pill text-white fw-semibold active bg-white bg-opacity-25"
              href="index.html">Tarefas</a>
          </li>
          <li class="nav-item">
            <a class="nav-link px-3 rounded-pill text-white fw-semibold" href="dashboard.html">Dashboard</a>
          </li>
        </ul>
      </div>
    </div>
  </nav>

  <main class="container py-4">
    <!-- Dashboard Cards -->
    <div class="row g-3 mb-4">
      <div class="col-md-4">
        <div class="card text-center shadow-sm h-100">
          <div class="card-body">
            <span class="fs-2">üìã</span>
            <h5 class="card-title mt-2">Total de Tarefas</h5>
            <h2 id="total-tasks" class="fw-bold">0</h2>
          </div>
        </div>
      </div>
      <div class="col-md-4">
        <div class="card text-center shadow-sm h-100">
          <div class="card-body">
            <span class="fs-2">‚úÖ</span>
            <h5 class="card-title mt-2">Conclu√≠das</h5>
            <h2 id="completed-tasks" class="fw-bold">0</h2>
          </div>
        </div>
      </div>
      <div class="col-md-4">
        <div class="card text-center shadow-sm h-100">
          <div class="card-body">
            <span class="fs-2">‚è≥</span>
            <h5 class="card-title mt-2">Pendentes</h5>
            <h2 id="pending-tasks" class="fw-bold">0</h2>
          </div>
        </div>
      </div>
    </div>

    <!-- Filtros e busca -->
    <form class="row g-2 align-items-end mb-4" id="filters-form" autocomplete="off">
      <div class="col-md-4">
        <label for="search-input" class="form-label">Buscar tarefa</label>
        <input type="text" id="search-input" class="form-control" placeholder="Buscar tarefa...">
      </div>
      <div class="col-md-3">
        <label for="filter-category" class="form-label">Categoria</label>
        <select id="filter-category" class="form-select"></select>
      </div>
      <div class="col-md-3">
        <label for="filter-priority" class="form-label">Prioridade</label>
        <select id="filter-priority" class="form-select">
          <option value="">Todas prioridades</option>
          <option value="baixa">Baixa</option>
          <option value="media">M√©dia</option>
          <option value="alta">Alta</option>
        </select>
      </div>
      <div class="col-md-2 d-flex gap-2">
        <button id="export-btn" type="button" class="btn btn-outline-primary w-100" title="Exportar tarefas"
          data-bs-toggle="tooltip" data-bs-placement="top" aria-label="Exportar tarefas">
          <span class="bi bi-download"></span> Exportar
        </button>
        <input type="file" id="import-file" style="display:none;" accept=".json">
        <button id="import-btn" type="button" class="btn btn-outline-secondary w-100" title="Importar tarefas"
          data-bs-toggle="tooltip" data-bs-placement="top" aria-label="Importar tarefas">
          <span class="bi bi-upload"></span> Importar
        </button>
      </div>
    </form>

    <!-- Filtros R√°pidos -->
    <div class="mb-3 d-flex gap-2">
      <button class="btn btn-outline-secondary btn-sm" id="filter-today">Hoje</button>
      <button class="btn btn-outline-secondary btn-sm" id="filter-week">Esta semana</button>
      <button class="btn btn-outline-secondary btn-sm" id="filter-late">Atrasadas</button>
    </div>

    <!-- Adicionar tarefa -->
    <div class="card shadow-sm mb-4">
      <div class="card-body">
        <form id="task-form" class="row g-3 align-items-end" autocomplete="off">
          <div class="col-md-5">
            <label for="task-input" class="form-label">Nova tarefa</label>
            <input type="text" id="task-input" class="form-control" placeholder="Nova tarefa..." required
              maxlength="80">
          </div>
          <div class="col-md-3">
            <label for="category-input" class="form-label">Categoria</label>
            <input type="text" id="category-input" class="form-control" placeholder="Categoria" maxlength="30">
          </div>
          <div class="col-md-2">
            <label for="priority-input" class="form-label">Prioridade</label>
            <select id="priority-input" class="form-select" required>
              <option value="baixa">Baixa</option>
              <option value="media">M√©dia</option>
              <option value="alta">Alta</option>
            </select>
          </div>
          <div class="col-md-2">
            <label for="date-input" class="form-label">Data</label>
            <input type="date" id="date-input" class="form-control">
          </div>
          <div class="col-12 text-end">
            <button type="submit" class="btn btn-primary px-4">
              <span class="bi bi-plus-circle"></span> Adicionar
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- Lista de tarefas -->
    <ul id="task-list" class="list-group mb-5">
      <!-- Exemplo de item (ser√° gerado via JS) -->
      <!--
            <li class="list-group-item d-flex flex-column flex-md-row align-items-md-center justify-content-between gap-2" data-priority="alta">
                <div>
                    <span class="badge-category">Trabalho</span>
                    <span class="priority">Alta</span>
                    <span class="fw-semibold ms-2">Implementar autentica√ß√£o JWT</span>
                    <span class="due-date ms-2"><i class="bi bi-calendar-event"></i> 2025-06-10</span>
                </div>
                <div class="actions d-flex gap-2">
                    <button class="btn btn-success btn-sm" title="Concluir" data-bs-toggle="tooltip"><i class="bi bi-check2-circle"></i></button>
                    <button class="btn btn-info btn-sm edit-btn" title="Editar" data-bs-toggle="tooltip"><i class="bi bi-pencil"></i></button>
                    <button class="btn btn-danger btn-sm delete-btn" title="Excluir" data-bs-toggle="tooltip"><i class="bi bi-trash"></i></button>
                </div>
            </li>
            -->
      <li class="list-group-item d-flex flex-column flex-md-row align-items-md-center justify-content-between gap-2"
        data-priority="alta">
        <div>
          <span class="badge-category">Trabalho</span>
          <span class="priority">Alta</span>
          <span class="fw-semibold ms-2">Implementar autentica√ß√£o JWT</span>
          <span class="due-date ms-2"><i class="bi bi-calendar-event"></i> 2025-06-10</span>
        </div>
        <!-- Exemplo de bloco de a√ß√µes de uma tarefa -->
        <div class="actions d-flex gap-2 mt-2">
          <button class="btn btn-warning btn-sm in-progress-btn" title="Mover para Em andamento">
            <i class="bi bi-arrow-repeat"></i>
          </button>
          <button class="btn btn-primary btn-sm edit-btn" title="Editar">
            <i class="bi bi-pencil"></i>
          </button>
          <button class="btn btn-danger btn-sm delete-btn" title="Excluir">
            <i class="bi bi-trash"></i>
          </button>
          <button class="btn btn-success btn-sm complete-btn" title="Concluir">
            <i class="bi bi-check2-circle"></i>
          </button>
        </div>
        <!-- Subtarefas -->
        <ul class="subtasks list-unstyled ms-4 mt-2">
          <li>
            <input type="checkbox" checked>
            <span>Subtarefa conclu√≠da</span>
          </li>
          <li><input type="checkbox"> Subtarefa pendente</li>
        </ul>
      </li>
    </ul>

    <div class="d-flex align-items-center gap-2 mb-3 justify-content-end">
      <button id="toggle-view-btn" class="btn btn-outline-primary btn-sm">
        <i class="bi bi-kanban"></i> Kanban
      </button>
      <div class="dropdown d-inline">
        <button class="btn btn-light btn-sm dropdown-toggle" type="button" data-bs-toggle="dropdown">
          <i class="bi bi-palette"></i> Tema
        </button>
        <ul class="dropdown-menu">
          <li><a class="dropdown-item" href="#" data-theme="default">Padr√£o</a></li>
          <li><a class="dropdown-item" href="#" data-theme="dark">Escuro</a></li>
          <li><a class="dropdown-item" href="#" data-theme="green">Verde</a></li>
          <li><a class="dropdown-item" href="#" data-theme="red">Vermelho</a></li>
          <li><a class="dropdown-item" href="#" data-theme="blue">Azul Pastel</a></li>
        </ul>
      </div>
    </div>
  </main>

  <footer class="text-center text-muted py-4">
    <small>TaskFlow &copy; 2025</small>
  </footer>

  <!-- Toast -->
  <div id="toast"
    class="toast align-items-center text-bg-primary border-0 position-fixed top-0 start-50 translate-middle-x mt-4"
    role="alert" aria-live="assertive" aria-atomic="true" style="display:none;z-index:2000;">
    <div class="d-flex">
      <div class="toast-body"></div>
    </div>
  </div>

  <!-- Modal de confirma√ß√£o -->
  <div class="modal fade" id="modal-confirm" tabindex="-1" aria-labelledby="modalConfirmLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-body" id="modal-message">Tem certeza que deseja excluir?</div>
        <div class="modal-footer">
          <button type="button" class="btn btn-danger" id="modal-yes">Sim</button>
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" id="modal-no">N√£o</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal de Confirma√ß√£o de Exclus√£o -->
  <div class="modal fade" id="modal-confirm-delete" tabindex="-1" aria-labelledby="modalConfirmDeleteLabel"
    aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content border-0 shadow-lg">
        <div class="modal-header bg-danger text-white">
          <h5 class="modal-title" id="modalConfirmDeleteLabel"><i
              class="bi bi-exclamation-triangle-fill me-2"></i>Confirmar exclus√£o</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Fechar"></button>
        </div>
        <div class="modal-body text-center">
          <p class="fs-5 mb-3">Tem certeza que deseja excluir esta tarefa?</p>
          <p class="text-muted mb-0">Esta a√ß√£o <b>n√£o pode ser desfeita</b>.</p>
        </div>
        <div class="modal-footer justify-content-center border-0">
          <button type="button" class="btn btn-secondary px-4" data-bs-dismiss="modal">Cancelar</button>
          <button type="button" class="btn btn-danger px-4" id="confirm-delete-btn" onclick="confirmDeleteTask()">Excluir</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal Configura√ß√µes -->
  <div class="modal fade" id="modal-config" tabindex="-1" aria-labelledby="modalConfigLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="modalConfigLabel">Configura√ß√µes</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <!-- Prefer√™ncias aqui -->
          <div class="mb-3">
            <label class="form-label">Tema</label>
            <select class="form-select" id="config-theme">
              <option value="default">Padr√£o</option>
              <option value="dark">Escuro</option>
              <option value="green">Verde</option>
              <option value="red">Vermelho</option>
              <option value="blue">Azul Pastel</option>
            </select>
          </div>
          <div class="mb-3">
            <label class="form-label">Notifica√ß√µes</label>
            <input type="checkbox" id="config-notify"> Ativar notifica√ß√µes
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-primary" data-bs-dismiss="modal">Salvar</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal Editar Tarefa -->
  <div class="modal fade" id="modal-edit-task" tabindex="-1" aria-labelledby="modalEditTaskLabel" aria-hidden="true">
    <div class="modal-dialog">
      <form class="modal-content" id="edit-task-form">
        <div class="modal-header">
          <h5 class="modal-title" id="modalEditTaskLabel">Editar tarefa</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <div class="mb-3">
            <label for="edit-task-title" class="form-label">T√≠tulo</label>
            <input type="text" class="form-control" id="edit-task-title" required maxlength="80">
          </div>
          <div class="mb-3">
            <label for="edit-task-category" class="form-label">Categoria</label>
            <input type="text" class="form-control" id="edit-task-category" maxlength="30">
          </div>
          <div class="mb-3">
            <label for="edit-task-priority" class="form-label">Prioridade</label>
            <select class="form-select" id="edit-task-priority">
              <option value="baixa">Baixa</option>
              <option value="media">M√©dia</option>
              <option value="alta">Alta</option>
            </select>
          </div>
          <div class="mb-3">
            <label for="edit-task-date" class="form-label">Data</label>
            <input type="date" class="form-control" id="edit-task-date">
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
          <button type="submit" class="btn btn-primary">Salvar</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Bootstrap Icons CDN -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
  <!-- Bootstrap JS Bundle -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script type="module" src="js/script.js"></script>
  <script>
    // Ativa tooltips Bootstrap
    document.addEventListener('DOMContentLoaded', function () {
      var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
      tooltipTriggerList.forEach(function (tooltipTriggerEl) {
        new bootstrap.Tooltip(tooltipTriggerEl);
      });
    });

    document.addEventListener('keydown', (e) => {
      if (e.ctrlKey && e.key === 'Enter') {
        document.getElementById('task-form').requestSubmit();
      }
      // Exemplo: Delete para remover tarefa selecionada (precisa de sele√ß√£o via JS)
    });

    if (Notification.permission !== "granted") {
      Notification.requestPermission();
    }
    // Para notificar:
    new Notification("Tarefa pendente!", { body: "Voc√™ tem tarefas para hoje." });
  </script>
  <!-- Adicione no final do body -->
  <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.2/Sortable.min.js"></script>
  <!-- <script>
    new Sortable(document.getElementById('task-list'), {
      animation: 150,
      handle: '.list-group-item',
      onEnd: function (evt) {
        // Atualize a ordem no localStorage/DB conforme necess√°rio
      }
    });
  </script> -->
  <script>
    function applyTheme(theme) {
      document.body.classList.remove('dark', 'theme-green', 'theme-red', 'theme-blue');
      const navbar = document.getElementById('main-navbar');
      navbar.classList.remove('bg-primary', 'bg-dark', 'bg-success', 'bg-danger', 'bg-info');
      if (theme === "dark") {
        document.body.classList.add('dark');
        navbar.classList.add('bg-dark');
      } else if (theme === "green") {
        document.body.classList.add('theme-green');
        navbar.classList.add('bg-success');
      } else if (theme === "red") {
        document.body.classList.add('theme-red');
        navbar.classList.add('bg-danger');
      } else if (theme === "blue") {
        document.body.classList.add('theme-blue');
        navbar.classList.add('bg-info');
      } else {
        navbar.classList.add('bg-primary');
      }
      localStorage.setItem('theme', theme);
    }

    // Troca de tema pelo dropdown
    document.querySelectorAll('[data-theme]').forEach(item => {
      item.addEventListener('click', function (e) {
        e.preventDefault();
        const theme = this.getAttribute('data-theme');
        applyTheme(theme);
      });
    });

    // Aplica tema salvo ao carregar
    const savedTheme = localStorage.getItem('theme') || 'default';
    applyTheme(savedTheme);
  </script>
</body>

</html>